<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="gof.gpt5.dao.PaymentDao">


	<!-- 코인 충전 내역 -->
	<insert id="addPayment" parameterType="gof.gpt5.dto.PaymentDto">
		insert into
		payment(NICKNAME, amount, orderid, ordername, paymentkey, wdate)
		values(#{nickname}, #{amount}, #{orderid}, #{ordername},
		#{paymentkey}, now())
	</insert>

	<!-- 코인 결제 내역 -->
	<insert id="addCoinPayment"
		parameterType="gof.gpt5.dto.CoinPaymentDto">
		insert into
		coinpayment(paymentkey,amount, buyer, seller,
		ordername, wdate)
		values(#{paymentkey}, #{amount}, #{buyer},
		#{seller},
		#{ordername}, now())
	</insert>

	<!-- 구매자 코인 업데이트 -->
	<update id="updateBuyerCoin"
		parameterType="gof.gpt5.dto.MemberDto">
		update member
		set coin = coin - #{coin}
		where nickname =
		#{nickname}
	</update>

	<!-- 판매자 코인 업데이트 -->
	<update id="updateSellerCoin"
		parameterType="gof.gpt5.dto.MemberDto">
		update member
		set coin = coin + #{coin}
		where nickname =
		#{nickname}
	</update>

	<select id="getPaymentBbs"
		parameterType="gof.gpt5.dto.MemberDto" resultType="gof.gpt5.dto.PaymentDto">
		select nickname, amount, orderid, ordername, paymentkey, wdate
		from payment
		where nickname = #{nickname}
	</select>

</mapper>